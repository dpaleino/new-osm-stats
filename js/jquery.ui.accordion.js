(function(a){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()==location.href.toLowerCase()}},_create:function(){var e=this.options,b=this;this.running=0;this.element.addClass("ui-accordion ui-widget ui-helper-reset");if(this.element[0].nodeName=="UL"){this.element.children("li").addClass("ui-accordion-li-fix")}this.headers=this.element.find(e.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){a(this).removeClass("ui-state-focus")});this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(e.navigation){var d=this.element.find("a").filter(e.navigationFilter);if(d.length){var c=d.closest(".ui-accordion-header");if(c.length){this.active=c}else{this.active=d.closest(".ui-accordion-content").prev()}}}this.active=this._findActive(this.active||e.active).toggleClass("ui-state-default").toggleClass("ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");this.active.next().addClass("ui-accordion-content-active");this._createIcons();if(a.browser.msie){this.element.find("a").css("zoom","1")}this.resize();this.element.attr("role","tablist");this.headers.attr("role","tab").bind("keydown",function(f){return b._keydown(f)}).next().attr("role","tabpanel");this.headers.not(this.active||"").attr("aria-expanded","false").attr("tabIndex","-1").next().hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex","0")}else{this.active.attr("aria-expanded","true").attr("tabIndex","0")}if(!a.browser.safari){this.headers.find("a").attr("tabIndex","-1")}if(e.event){this.headers.bind((e.event)+".accordion",function(f){b._clickHandler.call(b,f,this);f.preventDefault()})}},_createIcons:function(){var b=this.options;if(b.icons){a("<span/>").addClass("ui-icon "+b.icons.header).prependTo(this.headers);this.active.find(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var c=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role").unbind(".accordion").removeData("accordion");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("tabindex");this.headers.find("a").removeAttr("tabindex");this._destroyIcons();var b=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active");if(c.autoHeight||c.fillHeight){b.css("height","")}return this},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);if(b=="active"){this.activate(c)}if(b=="icons"){this._destroyIcons();if(c){this._createIcons()}}},_keydown:function(e){var f=this.options,g=a.ui.keyCode;if(f.disabled||e.altKey||e.ctrlKey){return}var d=this.headers.length;var c=this.headers.index(e.target);var b=false;switch(e.keyCode){case g.RIGHT:case g.DOWN:b=this.headers[(c+1)%d];break;case g.LEFT:case g.UP:b=this.headers[(c-1+d)%d];break;case g.SPACE:case g.ENTER:this._clickHandler({target:e.target},e.target);e.preventDefault()}if(b){a(e.target).attr("tabIndex","-1");a(b).attr("tabIndex","0");b.focus();return false}return true},resize:function(){var d=this.options,b;if(d.fillSpace){if(a.browser.msie){var c=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}b=this.element.parent().height();if(a.browser.msie){this.element.parent().css("overflow",c)}this.headers.each(function(){b-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,b-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else{if(d.autoHeight){b=0;this.headers.next().each(function(){b=Math.max(b,a(this).height())}).height(b)}}return this},activate:function(b){this.options.active=b;var c=this._findActive(b)[0];this._clickHandler({target:c},c);return this},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(b,c){var d=this.options;if(d.disabled){return}if(!b.target){if(!d.collapsible){return}this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);this.active.next().addClass("ui-accordion-content-active");var j=this.active.next(),e={options:d,newHeader:a([]),oldHeader:d.active,newContent:a([]),oldContent:j},f=(this.active=a([]));this._toggle(f,j,e);return}var g=a(b.currentTarget||c);var h=g[0]==this.active[0];d.active=d.collapsible&&h?false:a(".ui-accordion-header",this.element).index(g);if(this.running||(!d.collapsible&&h)){return}this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(d.icons.headerSelected).addClass(d.icons.header);if(!h){g.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").find(".ui-icon").removeClass(d.icons.header).addClass(d.icons.headerSelected);g.next().addClass("ui-accordion-content-active")}var f=g.next(),j=this.active.next(),e={options:d,newHeader:h&&d.collapsible?a([]):g,oldHeader:this.active,newContent:h&&d.collapsible?a([]):f,oldContent:j},i=this.headers.index(this.active[0])>this.headers.index(g[0]);this.active=h?a([]):g;this._toggle(f,j,e,h,i);return},_toggle:function(h,m,f,i,j){var c=this.options,l=this;this.toShow=h;this.toHide=m;this.data=f;var g=function(){if(!l){return}return l._completed.apply(l,arguments)};this._trigger("changestart",null,this.data);this.running=m.size()===0?h.size():m.size();if(c.animated){var d={};if(c.collapsible&&i){d={toShow:a([]),toHide:m,complete:g,down:j,autoHeight:c.autoHeight||c.fillSpace}}else{d={toShow:h,toHide:m,complete:g,down:j,autoHeight:c.autoHeight||c.fillSpace}}if(!c.proxied){c.proxied=c.animated}if(!c.proxiedDuration){c.proxiedDuration=c.duration}c.animated=a.isFunction(c.proxied)?c.proxied(d):c.proxied;c.duration=a.isFunction(c.proxiedDuration)?c.proxiedDuration(d):c.proxiedDuration;var k=a.ui.accordion.animations,e=c.duration,b=c.animated;if(b&&!k[b]&&!a.easing[b]){b="slide"}if(!k[b]){k[b]=function(n){this.slide(n,{easing:b,duration:e||700})}}k[b](d)}else{if(c.collapsible&&i){h.toggle()}else{m.hide();h.show()}g(true)}m.prev().attr("aria-expanded","false").attr("tabIndex","-1").blur();h.prev().attr("aria-expanded","true").attr("tabIndex","0").focus()},_completed:function(b){var c=this.options;this.running=b?0:--this.running;if(this.running){return}if(c.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this.toHide.removeClass("ui-accordion-content-active");this._trigger("change",null,this.data)}});a.extend(a.ui.accordion,{version:"1.8",animations:{slide:function(e,h){e=a.extend({easing:"swing",duration:300},e,h);if(!e.toHide.size()){e.toShow.animate({height:"show"},e);return}if(!e.toShow.size()){e.toHide.animate({height:"hide"},e);return}var c=e.toShow.css("overflow"),f=0,d={},g={},j=["height","paddingTop","paddingBottom"],b;var i=e.toShow;b=i[0].style.width;i.width(parseInt(i.parent().width(),10)-parseInt(i.css("paddingLeft"),10)-parseInt(i.css("paddingRight"),10)-(parseInt(i.css("borderLeftWidth"),10)||0)-(parseInt(i.css("borderRightWidth"),10)||0));a.each(j,function(k,m){g[m]="hide";var l=(""+a.css(e.toShow[0],m)).match(/^([\d+-.]+)(.*)$/);d[m]={value:l[1],unit:l[2]||"px"}});e.toShow.css({height:0,overflow:"hidden"}).show();e.toHide.filter(":hidden").each(e.complete).end().filter(":visible").animate(g,{step:function(k,l){if(l.prop=="height"){f=(l.end-l.start===0)?0:(l.now-l.start)/(l.end-l.start)}e.toShow[0].style[l.prop]=(f*d[l.prop].value)+d[l.prop].unit},duration:e.duration,easing:e.easing,complete:function(){if(!e.autoHeight){e.toShow.css("height","")}e.toShow.css("width",b);e.toShow.css({overflow:c});e.complete()}})},bounceslide:function(b){this.slide(b,{easing:b.down?"easeOutBounce":"swing",duration:b.down?1000:200})}}})})(jQuery);