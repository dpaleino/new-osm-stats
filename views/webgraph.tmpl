<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      lang="it">
<head>
<meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
<title>Generatore grafici statistiche OSM</title>
<script src="/js/jquery.min.js"></script>
<script>
<!--
    var query = "";

    $(document).ready(function() {
        $('#form').submit(function(x) {
            x.preventDefault();
            //alert($(this).serialize());
            //$('div#graph').html('<img src="/graph?'+$(this).serialize()+'" />');
            $('div#graph').html('<iframe src="/graph?'+$(this).serialize()+'" width="640" height="480"></iframe>');
            $('div#graph').fadeIn('slow');
        });

        $('select[name=tag]').change(function() {
            $('div#graph').fadeOut('slow');
            var value = $('select[name=tag] option:selected').val();
            $.getJSON('/get/users/'+value, null, function(j) {
                var opts = '';
                var names = j.r;

                for (var i=0; i < names.length; i++) {
                    opts += '<option value="'+names[i]+'">'+names[i]+'</option>';
                }
                
                $('select[name=user]').html(opts);
            });
        });
    });
//-->
</script>
<link rel="stylesheet" type="text/css" href="osmstats_style.css" />
</head>
<body>
<div align="center">
  <h1>Dynamic graph generator</h1>
  <form id="form" action="/graph" method="get">
    <label for="search_tags">Tags:</label><br />
    <select name="tag">
      <option selected="selected">--- Select tag ---</option>
      <py:for each="tag in tags">
        <option value="${tag}">${tag}</option>
      </py:for>
    </select>
    <br />
    <label for="user">Users:</label><br />
    <select name="user" multiple="multiple" size="5">
    </select>
    <br />
    <input type="Submit" value="Graph!" />
  </form>
  <br />
  <br />
  <div id="graph">
  </div>
</div>
</body>
</html>
